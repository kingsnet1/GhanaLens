<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GhanaLens - Your Window to Ghana</title>
    <link rel="icon" href="images/favicon.jpg" type="image/x-icon">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Quill Rich Text Editor -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    
    <style>
        :root {
            --red: #CE1126;
            --yellow: #FCD116;
            --green: #006B3F;
            --dark-green: #004d29;
            --light-yellow: #fff9e6;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
            --medium-gray: #777;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #fff;
            color: var(--dark-gray);
            line-height: 1.6;
        }
        
        a {
            text-decoration: none;
            color: inherit;
        }
        
        ul {
            list-style: none;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo h1 {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--green), var(--yellow), var(--red));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        nav ul {
            display: flex;
            gap: 25px;
        }
        
        nav a {
            font-weight: 600;
            transition: color 0.3s;
            position: relative;
        }
        
        nav a:hover {
            color: var(--green);
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--green);
            transition: width 0.3s;
        }
        
        nav a:hover::after {
            width: 100%;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 20px;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-outline {
            border: 2px solid var(--green);
            color: var(--green);
            background: transparent;
        }
        
        .btn-outline:hover {
            background-color: var(--green);
            color: white;
        }
        
        .btn-filled {
            background-color: var(--green);
            color: white;
            border: 2px solid var(--green);
        }
        
        .btn-filled:hover {
            background-color: var(--dark-green);
            border-color: var(--dark-green);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            text-align: center;
        }
        
        .hero h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        /* Main Posts Grid Section */
        .main-posts {
            padding: 80px 0 50px;
            background: linear-gradient(to bottom, #ffffff, #f8f9fa);
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-header h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--green), var(--dark-green));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .section-header p {
            font-size: 1.1rem;
            color: var(--medium-gray);
            max-width: 600px;
            margin: 0 auto;
        }
        
        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .grid-post-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            cursor: pointer;
        }
        
        .grid-post-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .grid-post-card.featured {
            grid-column: span 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
        }
        
        .post-image-container {
            position: relative;
            overflow: hidden;
        }
        
        .grid-post-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: var(--transition);
        }
        
        .grid-post-card:hover .grid-post-image {
            transform: scale(1.05);
        }
        
        .featured .grid-post-image {
            height: 100%;
            min-height: 300px;
        }
        
        .post-category-tag {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--green);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .post-content {
            padding: 25px;
        }
        
        .featured .post-content {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .post-meta {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
            font-size: 0.85rem;
            color: var(--medium-gray);
        }
        
        .post-date {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .post-title {
            font-size: 1.3rem;
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 12px;
            color: var(--dark-gray);
        }
        
        .featured .post-title {
            font-size: 1.8rem;
            line-height: 1.3;
        }
        
        .post-excerpt {
            color: var(--medium-gray);
            line-height: 1.6;
            margin-bottom: 20px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .post-comment-count {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--medium-gray);
            font-size: 0.85rem;
            margin-top: 15px;
        }
        
        .read-more {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--green);
            font-weight: 600;
            transition: var(--transition);
        }
        
        .read-more:hover {
            color: var(--dark-green);
            gap: 12px;
        }
        
        .view-all-container {
            text-align: center;
            margin-top: 30px;
        }
        
        /* Featured Posts Section */
        .section-title {
            text-align: center;
            margin: 50px 0 30px;
            position: relative;
        }
        
        .section-title h2 {
            font-size: 2rem;
            display: inline-block;
            padding: 0 20px;
            background-color: white;
            position: relative;
            z-index: 1;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(to right, var(--green), var(--yellow), var(--red));
            z-index: 0;
        }
        
        .featured-posts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .post-card {
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .post-card:hover {
            transform: translateY(-10px);
        }
        
        .post-image {
            height: 200px;
            width: 100%;
            object-fit: cover;
        }
        
        .post-content-old {
            padding: 20px;
        }
        
        .post-category {
            display: inline-block;
            background-color: var(--light-yellow);
            color: var(--dark-gray);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .post-title-old {
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .post-excerpt-old {
            color: var(--medium-gray);
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .post-meta-old {
            display: flex;
            justify-content: space-between;
            color: var(--medium-gray);
            font-size: 0.8rem;
        }
        
        /* Categories Section */
        .categories {
            background-color: var(--light-gray);
            padding: 50px 0;
        }
        
        .category-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }
        
        .category-item {
            background-color: white;
            padding: 15px 25px;
            border-radius: 30px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .category-item:hover {
            background-color: var(--green);
            color: white;
            transform: translateY(-5px);
        }
        
        /* Footer */
        footer {
            background-color: var(--dark-gray);
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-logo h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--green), var(--yellow), var(--red));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .footer-links h3, .footer-newsletter h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            position: relative;
            padding-bottom: 10px;
        }
        
        .footer-links h3::after, .footer-newsletter h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 2px;
            background: linear-gradient(to right, var(--green), var(--yellow), var(--red));
        }
        
        .footer-links ul li {
            margin-bottom: 10px;
        }
        
        .footer-links ul li a:hover {
            color: var(--yellow);
        }
        
        .footer-newsletter p {
            margin-bottom: 15px;
        }
        
        .newsletter-form {
            display: flex;
        }
        
        .newsletter-form input {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 4px 0 0 4px;
        }
        
        .newsletter-form button {
            background-color: var(--green);
            color: white;
            border: none;
            padding: 0 15px;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .newsletter-form button:hover {
            background-color: var(--dark-green);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
            color: rgba(255,255,255,0.7);
        }
        
        /* Enhanced Admin Dashboard Styles */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        .admin-sidebar {
            width: 280px;
            background: linear-gradient(135deg, var(--dark-gray) 0%, #2c3e50 100%);
            color: white;
            padding: 0;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        
        .admin-logo {
            padding: 30px 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-align: center;
            background: rgba(0,0,0,0.2);
        }
        
        .logo-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--green);
        }
        
        .admin-logo h2 {
            font-size: 1.4rem;
            margin-bottom: 5px;
            background: none;
            color: white;
        }
        
        .admin-logo p {
            font-size: 0.8rem;
            opacity: 0.7;
            margin: 0;
        }
        
        .admin-menu {
            flex: 1;
            padding: 20px 0;
        }
        
        .admin-menu ul li {
            margin-bottom: 5px;
            position: relative;
        }
        
        .admin-menu ul li a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            transition: all 0.3s ease;
            color: rgba(255,255,255,0.8);
            border-left: 3px solid transparent;
        }
        
        .admin-menu ul li a i {
            width: 20px;
            margin-right: 15px;
            font-size: 1.1rem;
        }
        
        .admin-menu ul li a:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: var(--green);
        }
        
        .admin-menu ul li a.active {
            background: linear-gradient(90deg, rgba(0,107,63,0.2) 0%, transparent 100%);
            color: white;
            border-left-color: var(--green);
        }
        
        .menu-badge {
            background: var(--red);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: auto;
        }
        
        .logout-item {
            margin-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 10px;
        }
        
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            background: rgba(0,0,0,0.2);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .user-avatar {
            font-size: 2rem;
            color: var(--green);
        }
        
        .user-details {
            flex: 1;
        }
        
        .user-name {
            display: block;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .user-role {
            font-size: 0.7rem;
            opacity: 0.7;
        }
        
        /* Admin Header */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .sidebar-toggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--dark-gray);
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .sidebar-toggle:hover {
            background: var(--light-gray);
        }
        
        .admin-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-gray);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .online-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: var(--green);
            background: rgba(0,107,63,0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }
        
        .online-status i {
            font-size: 0.6rem;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--green), var(--yellow));
        }
        
        .stat-card.primary::before { background: linear-gradient(90deg, #3498db, #2980b9); }
        .stat-card.success::before { background: linear-gradient(90deg, var(--green), var(--dark-green)); }
        .stat-card.warning::before { background: linear-gradient(90deg, var(--yellow), #f39c12); }
        .stat-card.danger::before { background: linear-gradient(90deg, var(--red), #c0392b); }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .stat-card.primary .stat-icon { background: linear-gradient(135deg, #3498db, #2980b9); }
        .stat-card.success .stat-icon { background: linear-gradient(135deg, var(--green), var(--dark-green)); }
        .stat-card.warning .stat-icon { background: linear-gradient(135deg, var(--yellow), #f39c12); }
        .stat-card.danger .stat-icon { background: linear-gradient(135deg, var(--red), #c0392b); }
        
        .stat-info {
            flex: 1;
        }
        
        .stat-info h3 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark-gray);
        }
        
        .stat-info p {
            color: var(--medium-gray);
            font-size: 0.9rem;
            margin: 0;
        }
        
        .stat-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--green);
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        /* Dashboard Content */
        .dashboard-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        
        .chart-card, .recent-activity, .quick-actions {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 25px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-header h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin: 0;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-icon {
            background: none;
            border: none;
            padding: 8px;
            border-radius: 6px;
            color: var(--medium-gray);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-icon:hover {
            background: var(--light-gray);
            color: var(--dark-gray);
        }
        
        .btn-text {
            background: none;
            border: none;
            color: var(--green);
            cursor: pointer;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .btn-text:hover {
            background: rgba(0,107,63,0.1);
        }
        
        /* Chart Placeholder */
        .chart-placeholder {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--light-gray);
            border-radius: 8px;
        }
        
        .chart-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* Activity List */
        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: var(--light-gray);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .activity-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
        }
        
        .activity-icon.primary { background: #3498db; }
        .activity-icon.success { background: var(--green); }
        .activity-icon.warning { background: var(--yellow); }
        .activity-icon.danger { background: var(--red); }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-content p {
            margin: 0 0 5px 0;
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        .activity-content span {
            font-size: 0.8rem;
            color: var(--medium-gray);
        }
        
        /* Quick Actions */
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .action-btn {
            background: white;
            border: 2px solid var(--light-gray);
            padding: 20px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            text-align: center;
        }
        
        .action-btn:hover {
            border-color: var(--green);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .action-btn i {
            font-size: 1.5rem;
            color: var(--green);
        }
        
        .action-btn span {
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        /* Enhanced Admin Cards */
        .admin-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .admin-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .admin-content {
            flex: 1;
            padding: 30px;
            background-color: var(--light-gray);
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn-admin {
            background-color: var(--green);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-admin:hover {
            background-color: var(--dark-green);
        }
        
        .btn-danger {
            background-color: var(--red);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-danger:hover {
            background-color: #a00;
        }
        
        /* Alert Messages */
        .alert {
            padding: 12px 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-dismissible {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            animation: slideIn 0.3s ease;
        }
        
        .alert-content {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }
        
        .alert-close {
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: background 0.3s ease;
        }
        
        .alert-close:hover {
            background: rgba(255,255,255,0.2);
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: var(--medium-gray);
        }
        
        /* Rich Text Editor Styles */
        .editor-container {
            margin-bottom: 20px;
        }
        
        #editor, #edit-post-editor {
            height: 300px;
        }
        
        /* Image Upload Styles */
        .image-upload-container {
            margin-bottom: 20px;
        }
        
        .image-preview {
            max-width: 100%;
            max-height: 300px;
            margin-top: 10px;
            display: none;
        }
        
        /* Comments Section */
        .comments-section {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--light-gray);
        }
        
        .comments-section h3 {
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .comment-form {
            background-color: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .comment {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: var(--medium-gray);
        }
        
        .comment-author {
            font-weight: 600;
        }
        
        .comment-content {
            line-height: 1.5;
        }
        
        .no-comments {
            text-align: center;
            padding: 20px;
            color: var(--medium-gray);
            font-style: italic;
        }
        
        /* Post Detail Page Styles */
        .post-detail {
            padding: 60px 0;
            background: white;
        }
        
        .post-detail-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .post-detail-title {
            font-size: 2.5rem;
            margin-bottom: 20px;
            line-height: 1.3;
        }
        
        .post-detail-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            color: var(--medium-gray);
        }
        
        .post-detail-category {
            background-color: var(--light-yellow);
            color: var(--dark-gray);
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .post-detail-image {
            width: 100%;
            height: 400px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        
        .post-detail-content {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 40px;
        }
        
        .post-detail-content h2 {
            font-size: 1.8rem;
            margin: 30px 0 15px;
        }
        
        .post-detail-content p {
            margin-bottom: 20px;
        }
        
        /* Category Management Styles */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .category-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .category-card h3 {
            margin-bottom: 10px;
        }
        
        .category-card p {
            color: var(--medium-gray);
            margin-bottom: 15px;
        }
        
        .category-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Edit Post Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--medium-gray);
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .admin-sidebar {
                width: 80px;
            }
            
            .admin-logo h2,
            .admin-logo p,
            .admin-menu span,
            .user-details,
            .menu-badge {
                display: none;
            }
            
            .admin-menu ul li a {
                justify-content: center;
                padding: 15px;
            }
            
            .admin-menu ul li a i {
                margin-right: 0;
                font-size: 1.3rem;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
            }
            
            nav ul {
                gap: 15px;
            }
            
            .hero h2 {
                font-size: 2rem;
            }
            
            .grid-post-card.featured {
                grid-column: span 1;
                grid-template-columns: 1fr;
            }
            
            .posts-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header h2 {
                font-size: 2rem;
            }
            
            .admin-container {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
            }
            
            .post-detail-title {
                font-size: 2rem;
            }
            
            .post-detail-image {
                height: 250px;
            }
            
            .categories-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .actions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Main Blog Site -->
    <div id="blog-site">
        <header>
            <div class="container header-container">
                <div class="logo">
                    <div style="width: 40px; height: 40px; background: linear-gradient(to right, var(--green), var(--yellow), var(--red)); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                        <span style="color: white; font-weight: bold;">GL</span>
                    </div>
                    <h1>GhanaLens</h1>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="categories.html">Categories</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </nav>
                <div class="auth-buttons">
                    <button class="btn btn-outline" onclick="showLogin()">Admin Login</button>
                </div>
            </div>
        </header>

        <!-- Homepage Content -->
        <div id="homepage-content">
            <section class="hero">
                <div class="container">
                    <h2>Your Window to Ghana</h2>
                    <p>Stay updated with the latest news, stories, and insights from Ghana and beyond</p>
                    <button class="btn btn-filled" onclick="refreshPosts()">Refresh Posts</button>
                    <button class="btn btn-outline" onclick="createSamplePost()">Create Sample Post</button>
                </div>
            </section>

            <!-- Main Posts Grid Section -->
            <section class="main-posts">
                <div class="container">
                    <div class="section-header">
                        <h2>Latest Stories</h2>
                        <p>Discover the most recent and engaging content from GhanaLens</p>
                    </div>
                    <div class="posts-grid" id="posts-grid">
                        <div class="loading">Loading latest posts...</div>
                    </div>
                    <div class="view-all-container">
                        <button class="btn btn-filled" onclick="loadMorePosts()">Load More Stories</button>
                    </div>
                </div>
            </section>

            <div class="container">
                <div class="section-title">
                    <h2>Featured Posts</h2>
                </div>
                <div class="featured-posts" id="featured-posts">
                    <div class="loading">Loading featured posts...</div>
                </div>

                <div class="section-title">
                    <h2>Categories</h2>
                </div>
            </div>

            <section class="categories">
                <div class="container">
                    <div class="category-list" id="category-list">
                        <!-- Categories will be loaded here -->
                    </div>
                </div>
            </section>

            <footer>
                <div class="container">
                    <div class="footer-content">
                        <div class="footer-logo">
                            <h2>GhanaLens</h2>
                            <p>Your trusted source for news and stories from Ghana and beyond.</p>
                        </div>
                        <div class="footer-links">
                            <h3>Quick Links</h3>
                            <ul>
                                <li><a href="index.html">Home</a></li>
                                <li><a href="categories.html">Categories</a></li>
                                <li><a href="about.html">About Us</a></li>
                                <li><a href="contact.html">Contact</a></li>
                            </ul>
                        </div>
                        <div class="footer-newsletter">
                            <h3>Newsletter</h3>
                            <p>Subscribe to our newsletter to get updates on new articles.</p>
                            <form class="newsletter-form">
                                <input type="email" placeholder="Your email address">
                                <button type="submit">Subscribe</button>
                            </form>
                        </div>
                    </div>
                    <div class="footer-bottom">
                        <p>&copy; 2023 GhanaLens. All rights reserved.</p>
                    </div>
                </div>
            </footer>
        </div>

        <!-- Post Detail View (Initially Hidden) -->
        <div id="post-detail-view" style="display: none;">
            <section class="post-detail">
                <div class="container post-detail-container">
                    <div class="post-detail-meta">
                        <span class="post-detail-category" id="post-detail-category">Category</span>
                        <span id="post-detail-date">Date</span>
                    </div>
                    <h1 class="post-detail-title" id="post-detail-title">Post Title</h1>
                    <img src="" alt="" class="post-detail-image" id="post-detail-image">
                    <div class="post-detail-content" id="post-detail-content">
                        <!-- Post content will be loaded here -->
                    </div>

                    <!-- Comments Section -->
                    <div class="comments-section">
                        <h3>Comments</h3>
                        <div id="comments-list">
                            <div class="no-comments">No comments yet. Be the first to comment!</div>
                        </div>
                        <div class="comment-form">
                            <h4>Leave a Comment</h4>
                            <form id="comment-form">
                                <div class="form-group">
                                    <label for="comment-author">Your Name</label>
                                    <input type="text" id="comment-author" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="comment-content">Your Comment</label>
                                    <textarea id="comment-content" class="form-control" rows="4" required placeholder="Share your thoughts..."></textarea>
                                </div>
                                <button type="submit" class="btn btn-filled">Post Comment</button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>

            <footer>
                <div class="container">
                    <div class="footer-content">
                        <div class="footer-logo">
                            <h2>GhanaLens</h2>
                            <p>Your trusted source for news and stories from Ghana and beyond.</p>
                        </div>
                        <div class="footer-links">
                            <h3>Quick Links</h3>
                            <ul>
                                <li><a href="index.html">Home</a></li>
                                <li><a href="categories.html">Categories</a></li>
                                <li><a href="about.html">About Us</a></li>
                                <li><a href="contact.html">Contact</a></li>
                            </ul>
                        </div>
                        <div class="footer-newsletter">
                            <h3>Newsletter</h3>
                            <p>Subscribe to our newsletter to get updates on new articles.</p>
                            <form class="newsletter-form">
                                <input type="email" placeholder="Your email address">
                                <button type="submit">Subscribe</button>
                            </form>
                        </div>
                    </div>
                    <div class="footer-bottom">
                        <p>&copy; 2023 GhanaLens. All rights reserved.</p>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Enhanced Professional Admin Dashboard -->
    <div id="admin-dashboard" style="display: none;">
        <div class="admin-container">
            <div class="admin-sidebar">
                <div class="admin-logo">
                    <div class="logo-icon">
                        <i class="fas fa-globe-africa"></i>
                    </div>
                    <h2>GhanaLens Admin</h2>
                    <p>Content Management</p>
                </div>
                <div class="admin-menu">
                    <ul>
                        <li>
                            <a href="#" class="active" onclick="showAdminSection('dashboard')">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="showAdminSection('add-post')">
                                <i class="fas fa-edit"></i>
                                <span>Create Post</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="showAdminSection('manage-posts')">
                                <i class="fas fa-newspaper"></i>
                                <span>Manage Posts</span>
                                <span class="menu-badge" id="posts-count-badge">0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="showAdminSection('manage-categories')">
                                <i class="fas fa-tags"></i>
                                <span>Categories</span>
                                <span class="menu-badge" id="categories-count-badge">0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="showAdminSection('manage-comments')">
                                <i class="fas fa-comments"></i>
                                <span>Comments</span>
                                <span class="menu-badge" id="comments-count-badge">0</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="showAdminSection('analytics')">
                                <i class="fas fa-chart-bar"></i>
                                <span>Analytics</span>
                            </a>
                        </li>
                        <li class="logout-item">
                            <a href="#" onclick="logout()">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>Logout</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-footer">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <div class="user-details">
                            <span class="user-name" id="admin-display-name">Administrator</span>
                            <span class="user-role">Super Admin</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="admin-content">
                <div class="admin-header">
                    <div class="header-left">
                        <button class="sidebar-toggle" onclick="toggleSidebar()">
                            <i class="fas fa-bars"></i>
                        </button>
                        <h1 id="admin-section-title">Dashboard</h1>
                    </div>
                    <div class="admin-user">
                        <div class="user-menu">
                            <span id="admin-email"></span>
                            <div class="online-status">
                                <i class="fas fa-circle"></i>
                                Online
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="alert-container"></div>
                
                <!-- Enhanced Dashboard Section -->
                <div id="dashboard-section" class="admin-section">
                    <div class="stats-grid">
                        <div class="stat-card primary">
                            <div class="stat-icon">
                                <i class="fas fa-newspaper"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-posts">0</h3>
                                <p>Total Posts</p>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>12%</span>
                            </div>
                        </div>
                        
                        <div class="stat-card success">
                            <div class="stat-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-comments">0</h3>
                                <p>Total Comments</p>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>8%</span>
                            </div>
                        </div>
                        
                        <div class="stat-card warning">
                            <div class="stat-icon">
                                <i class="fas fa-tags"></i>
                            </div>
                            <div class="stat-info">
                                <h3 id="total-categories">0</h3>
                                <p>Categories</p>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>5%</span>
                            </div>
                        </div>
                        
                        <div class="stat-card danger">
                            <div class="stat-icon">
                                <i class="fas fa-eye"></i>
                            </div>
                            <div class="stat-info">
                                <h3>2.5K</h3>
                                <p>Monthly Views</p>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i>
                                <span>15%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-content">
                        <div class="content-grid">
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Posts Overview</h3>
                                    <div class="card-actions">
                                        <button class="btn-icon"><i class="fas fa-sync-alt"></i></button>
                                    </div>
                                </div>
                                <div class="chart-placeholder">
                                    <div class="chart-container">
                                        <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: var(--medium-gray);">
                                            <i class="fas fa-chart-bar" style="font-size: 3rem; margin-right: 15px;"></i>
                                            <span>Posts Analytics Chart</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="recent-activity">
                                <div class="card-header">
                                    <h3>Recent Activity</h3>
                                    <div class="card-actions">
                                        <button class="btn-text">View All</button>
                                    </div>
                                </div>
                                <div class="activity-list">
                                    <div class="activity-item">
                                        <div class="activity-icon success">
                                            <i class="fas fa-plus"></i>
                                        </div>
                                        <div class="activity-content">
                                            <p>New post published</p>
                                            <span>2 minutes ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon primary">
                                            <i class="fas fa-comment"></i>
                                        </div>
                                        <div class="activity-content">
                                            <p>New comment received</p>
                                            <span>5 minutes ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon warning">
                                            <i class="fas fa-tag"></i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Category updated</p>
                                            <span>1 hour ago</span>
                                        </div>
                                    </div>
                                    <div class="activity-item">
                                        <div class="activity-icon danger">
                                            <i class="fas fa-trash"></i>
                                        </div>
                                        <div class="activity-content">
                                            <p>Post deleted</p>
                                            <span>2 hours ago</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="quick-actions">
                            <div class="card-header">
                                <h3>Quick Actions</h3>
                            </div>
                            <div class="actions-grid">
                                <button class="action-btn" onclick="showAdminSection('add-post')">
                                    <i class="fas fa-edit"></i>
                                    <span>Write New Post</span>
                                </button>
                                <button class="action-btn" onclick="showAdminSection('manage-categories')">
                                    <i class="fas fa-tags"></i>
                                    <span>Manage Categories</span>
                                </button>
                                <button class="action-btn" onclick="showAdminSection('manage-comments')">
                                    <i class="fas fa-comments"></i>
                                    <span>Moderate Comments</span>
                                </button>
                                <button class="action-btn" onclick="createSamplePost()">
                                    <i class="fas fa-magic"></i>
                                    <span>Create Sample</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Add Post Section -->
                <div id="add-post-section" class="admin-section" style="display: none;">
                    <div class="admin-card">
                        <h2>Create New Post</h2>
                        <form id="add-post-form">
                            <div class="form-group">
                                <label for="post-title">Post Title</label>
                                <input type="text" id="post-title" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="post-category">Category</label>
                                <select id="post-category" class="form-control" required>
                                    <option value="">Select a category</option>
                                    <!-- Categories will be loaded dynamically -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="post-excerpt">Excerpt</label>
                                <textarea id="post-excerpt" class="form-control" required placeholder="Brief description of the post"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="featured-image">Featured Image URL</label>
                                <input type="text" id="featured-image" class="form-control" required 
                                       placeholder="https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5...">
                            </div>
                            <div class="form-group">
                                <label for="post-content">Post Content</label>
                                <div id="editor"></div>
                            </div>
                            <button type="submit" class="btn-admin">
                                <i class="fas fa-paper-plane"></i>
                                Publish Post
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Manage Posts Section -->
                <div id="manage-posts-section" class="admin-section" style="display: none;">
                    <div class="admin-card">
                        <h2>Manage Posts</h2>
                        <div id="posts-list">
                            <div class="loading">Loading posts...</div>
                        </div>
                    </div>
                </div>
                
                <!-- Manage Categories Section -->
                <div id="manage-categories-section" class="admin-section" style="display: none;">
                    <div class="admin-card">
                        <h2>Manage Categories</h2>
                        <div class="form-group">
                            <h3>Add New Category</h3>
                            <form id="add-category-form">
                                <div class="form-group">
                                    <label for="category-name">Category Name</label>
                                    <input type="text" id="category-name" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label for="category-description">Description</label>
                                    <textarea id="category-description" class="form-control" placeholder="Brief description of the category"></textarea>
                                </div>
                                <button type="submit" class="btn-admin">
                                    <i class="fas fa-plus"></i>
                                    Add Category
                                </button>
                            </form>
                        </div>
                        <div class="form-group">
                            <h3>Existing Categories</h3>
                            <div id="categories-list-admin">
                                <div class="loading">Loading categories...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Manage Comments Section -->
                <div id="manage-comments-section" class="admin-section" style="display: none;">
                    <div class="admin-card">
                        <h2>Manage Comments</h2>
                        <div id="comments-list-admin">
                            <div class="loading">Loading comments...</div>
                        </div>
                    </div>
                </div>

                <!-- Analytics Section -->
                <div id="analytics-section" class="admin-section" style="display: none;">
                    <div class="admin-card">
                        <h2>Site Analytics</h2>
                        <div class="analytics-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div class="metric-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h3>Traffic Overview</h3>
                                <div class="chart-placeholder" style="height: 200px; display: flex; align-items: center; justify-content: center; background: var(--light-gray); border-radius: 8px; margin-top: 15px;">
                                    <div style="text-align: center; color: var(--medium-gray);">
                                        <i class="fas fa-chart-line" style="font-size: 3rem; display: block; margin-bottom: 10px;"></i>
                                        <span>Traffic Analytics Chart</span>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-card" style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                                <h3>Top Categories</h3>
                                <div class="category-stats" style="margin-top: 15px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: var(--light-gray); border-radius: 4px;">
                                        <span>News</span>
                                        <span style="font-weight: bold;">45%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: var(--light-gray); border-radius: 4px;">
                                        <span>Sports</span>
                                        <span style="font-weight: bold;">30%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: var(--light-gray); border-radius: 4px;">
                                        <span>Entertainment</span>
                                        <span style="font-weight: bold;">15%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: var(--light-gray); border-radius: 4px;">
                                        <span>Business</span>
                                        <span style="font-weight: bold;">10%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Post Modal -->
    <div id="edit-post-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Edit Post</h2>
                <button class="close-modal" onclick="closeEditModal()">&times;</button>
            </div>
            <form id="edit-post-form">
                <input type="hidden" id="edit-post-id">
                <div class="form-group">
                    <label for="edit-post-title">Post Title</label>
                    <input type="text" id="edit-post-title" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="edit-post-category">Category</label>
                    <select id="edit-post-category" class="form-control" required>
                        <option value="">Select a category</option>
                        <!-- Categories will be loaded dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-post-excerpt">Excerpt</label>
                    <textarea id="edit-post-excerpt" class="form-control" required placeholder="Brief description of the post"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-featured-image">Featured Image URL</label>
                    <input type="text" id="edit-featured-image" class="form-control" required 
                           placeholder="https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5...">
                </div>
                <div class="form-group">
                    <label for="edit-post-content">Post Content</label>
                    <div id="edit-post-editor"></div>
                </div>
                <button type="submit" class="btn-admin">
                    <i class="fas fa-save"></i>
                    Update Post
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="login-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background-color: white; padding: 30px; border-radius: 8px; width: 90%; max-width: 400px;">
            <h2 style="margin-bottom: 20px; text-align: center;">Admin Login</h2>
            <div id="login-alert"></div>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" class="form-control" required>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn btn-outline" onclick="hideLogin()" style="flex: 1;">Cancel</button>
                    <button type="submit" class="btn btn-filled" style="flex: 1;">Login</button>
                </div>
            </form>
            <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 4px; font-size: 0.9rem;">
                <p><strong>Demo Credentials:</strong></p>
                <p>Email: admin@ghanalens.com</p>
                <p>Password: password123</p>
            </div>
        </div>
    </div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDAkIlNKuh-ZbLS79MdIlJXLO9nAEfi82U",
            authDomain: "ghanalens-ea0a1.firebaseapp.com",
            projectId: "ghanalens-ea0a1",
            storageBucket: "ghanalens-ea0a1.firebasestorage.app",
            messagingSenderId: "62550513628",
            appId: "1:62550513628:web:84b60fb797ff0632656119"
        };

        // Initialize Firebase
        let auth, db, storage;
        try {
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase initialized successfully");
            
            // Initialize Firebase services
            auth = firebase.auth();
            db = firebase.firestore();
            storage = firebase.storage();
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }

        // Global variables
        let currentUser = null;
        let allPosts = [];
        let displayedPosts = 6;
        let quill, editQuill; // Rich text editor instances
        let currentPostId = null; // Track the current post being viewed
        let categories = []; // Store categories
        
        // Initialize Quill editors
        function initQuillEditors() {
            quill = new Quill('#editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link', 'image'],
                        ['clean']
                    ]
                },
                placeholder: 'Write your post content here...'
            });
            
            editQuill = new Quill('#edit-post-editor', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        ['link', 'image'],
                        ['clean']
                    ]
                },
                placeholder: 'Write your post content here...'
            });
        }
        
        // Load categories from Firestore
        function loadCategories() {
            if (!db) return;
            
            return db.collection('categories').orderBy('name').get()
                .then((querySnapshot) => {
                    categories = [];
                    
                    // If no categories exist, create default ones
                    if (querySnapshot.empty) {
                        const defaultCategories = [
                            { name: 'News', description: 'General news from Ghana' },
                            { name: 'Local News', description: 'Local news and events' },
                            { name: 'Sports', description: 'Sports news and updates' },
                            { name: 'Business', description: 'Business and economy news' },
                            { name: 'Entertainment', description: 'Entertainment and lifestyle' },
                            { name: 'Africa', description: 'News from across Africa' },
                            { name: 'Technology', description: 'Tech news and innovations' }
                        ];
                        
                        const promises = defaultCategories.map(cat => {
                            return db.collection('categories').add({
                                name: cat.name,
                                description: cat.description,
                                createdAt: firebase.firestore.FieldValue.serverTimestamp()
                            });
                        });
                        
                        return Promise.all(promises).then(() => {
                            // Reload categories after adding defaults
                            return loadCategories();
                        });
                    }
                    
                    // Process existing categories
                    querySnapshot.forEach((doc) => {
                        const category = {
                            id: doc.id,
                            ...doc.data()
                        };
                        categories.push(category);
                    });
                    
                    return categories;
                })
                .catch((error) => {
                    console.error("Error loading categories: ", error);
                    throw error;
                });
        }
        
        // Populate category dropdowns
        function populateCategoryDropdowns() {
            const postCategorySelect = document.getElementById('post-category');
            const editPostCategorySelect = document.getElementById('edit-post-category');
            
            // Clear existing options except the first one
            while (postCategorySelect.options.length > 1) {
                postCategorySelect.remove(1);
            }
            
            while (editPostCategorySelect.options.length > 1) {
                editPostCategorySelect.remove(1);
            }
            
            // Add categories to dropdowns
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                
                postCategorySelect.appendChild(option.cloneNode(true));
                editPostCategorySelect.appendChild(option);
            });
        }
        
        // Display categories on homepage
        function displayCategories() {
            const categoryList = document.getElementById('category-list');
            categoryList.innerHTML = '';
            
            if (categories.length === 0) {
                categoryList.innerHTML = '<p>No categories available.</p>';
                return;
            }
            
            categories.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.textContent = category.name;
                categoryItem.addEventListener('click', () => {
                    // In a real implementation, this would filter posts by category
                    alert(`Would show posts in category: ${category.name}`);
                });
                
                categoryList.appendChild(categoryItem);
            });
        }
        
        // Function to create URL-friendly slug from title
        function createSlug(title) {
            return title
                .toLowerCase()
                .trim()
                .replace(/[^\w\s-]/g, '')
                .replace(/[\s_-]+/g, '-')
                .replace(/^-+|-+$/g, '');
        }
        
        // Navigate to post detail page
        function navigateToPost(post) {
            // Show post detail view and hide homepage
            document.getElementById('homepage-content').style.display = 'none';
            document.getElementById('post-detail-view').style.display = 'block';
            
            // Load and display the post
            loadPostDetail(post);
        }
        
        // Load and display post detail
        function loadPostDetail(post) {
            currentPostId = post.id;
            
            // Update page title
            document.title = `${post.title} - GhanaLens`;
            
            // Update post elements
            document.getElementById('post-detail-category').textContent = post.category || 'General';
            document.getElementById('post-detail-title').textContent = post.title;
            
            // Format and display date
            const postDate = post.createdAt?.toDate();
            if (postDate) {
                document.getElementById('post-detail-date').textContent = postDate.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            }
            
            // Set featured image
            const featuredImage = document.getElementById('post-detail-image');
            if (post.featuredImage) {
                featuredImage.src = post.featuredImage;
                featuredImage.alt = post.title;
            } else {
                featuredImage.style.display = 'none';
            }
            
            // Display post content
            const postContent = document.getElementById('post-detail-content');
            if (post.content) {
                postContent.innerHTML = post.content;
            } else {
                postContent.innerHTML = `
                    <p>${post.excerpt || 'No content available for this post.'}</p>
                `;
            }
            
            // Load comments for this post
            loadComments(post.id);
        }
        
        // Go back to homepage from post detail
        function goBackToHomepage() {
            document.getElementById('post-detail-view').style.display = 'none';
            document.getElementById('homepage-content').style.display = 'block';
            document.title = 'GhanaLens - Your Window to Ghana';
            currentPostId = null;
        }
        
        // Load comments for a post
        function loadComments(postId) {
            const commentsList = document.getElementById('comments-list');
            commentsList.innerHTML = '<div class="loading">Loading comments...</div>';
            
            if (!db) {
                commentsList.innerHTML = '<div class="no-comments">Comments not available at the moment.</div>';
                return;
            }
            
            db.collection('comments')
                .where('postId', '==', postId)
                .orderBy('createdAt', 'desc')
                .get()
                .then((querySnapshot) => {
                    commentsList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        commentsList.innerHTML = '<div class="no-comments">No comments yet. Be the first to comment!</div>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const comment = doc.data();
                        const commentElement = document.createElement('div');
                        commentElement.className = 'comment';
                        commentElement.innerHTML = `
                            <div class="comment-header">
                                <span class="comment-author">${comment.author}</span>
                                <span class="comment-date">${comment.createdAt?.toDate().toLocaleDateString() || 'Recently'}</span>
                            </div>
                            <div class="comment-content">${comment.content}</div>
                        `;
                        commentsList.appendChild(commentElement);
                    });
                })
                .catch((error) => {
                    console.error("Error loading comments: ", error);
                    commentsList.innerHTML = '<div class="no-comments">Error loading comments. Please try again.</div>';
                });
        }
        
        // Submit a new comment with enhanced error handling
        function submitComment(event) {
            event.preventDefault();
            
            const author = document.getElementById('comment-author').value;
            const content = document.getElementById('comment-content').value;
            
            if (!author || !content) {
                showAlert('Please fill in all fields', 'error');
                return;
            }
            
            if (!currentPostId) {
                showAlert('No post selected', 'error');
                return;
            }
            
            if (!db) {
                showAlert('Database not available. Please try again later.', 'error');
                return;
            }
            
            const newComment = {
                postId: currentPostId,
                author: author,
                content: content,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                approved: true // Auto-approve for demo
            };
            
            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'Posting...';
            submitBtn.disabled = true;
            
            db.collection('comments').add(newComment)
                .then(() => {
                    // Clear form
                    document.getElementById('comment-form').reset();
                    // Reload comments
                    loadComments(currentPostId);
                    // Show success message
                    showAlert('Comment posted successfully!', 'success');
                })
                .catch((error) => {
                    console.error('Error posting comment:', error);
                    let errorMessage = 'Error posting comment: ';
                    
                    if (error.code === 'permission-denied') {
                        errorMessage += 'Permission denied. Please check Firebase security rules.';
                    } else {
                        errorMessage += error.message;
                    }
                    
                    showAlert(errorMessage, 'error');
                })
                .finally(() => {
                    // Restore button state
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                });
        }
        
        // Load blog posts
        function loadBlogPosts() {
            const postsGrid = document.getElementById('posts-grid');
            const featuredPosts = document.getElementById('featured-posts');
            
            postsGrid.innerHTML = '<div class="loading">Loading latest posts...</div>';
            featuredPosts.innerHTML = '<div class="loading">Loading featured posts...</div>';
            
            if (!db) {
                console.error("Firestore not initialized");
                postsGrid.innerHTML = '<div class="alert alert-error">Database connection error. Please refresh the page.</div>';
                featuredPosts.innerHTML = '<div class="alert alert-error">Database connection error.</div>';
                return;
            }
            
            db.collection('posts').get()
                .then((querySnapshot) => {
                    console.log(`Found ${querySnapshot.size} posts total`);
                    
                    allPosts = [];
                    querySnapshot.forEach((doc) => {
                        const postData = doc.data();
                        const post = {
                            id: doc.id,
                            ...postData
                        };
                        
                        if (post.published !== false) {
                            allPosts.push(post);
                        }
                    });
                    
                    console.log(`Loaded ${allPosts.length} published posts`);
                    
                    if (allPosts.length === 0) {
                        postsGrid.innerHTML = '<div class="alert alert-error">No posts available. Create your first post in the admin dashboard!</div>';
                        featuredPosts.innerHTML = '<div class="alert alert-error">No featured posts available.</div>';
                        return;
                    }
                    
                    // Sort posts by date (newest first)
                    allPosts.sort((a, b) => {
                        const dateA = a.createdAt ? a.createdAt.toDate() : new Date(0);
                        const dateB = b.createdAt ? b.createdAt.toDate() : new Date(0);
                        return dateB - dateA;
                    });
                    
                    // Display posts
                    displayPostsGrid();
                    displayFeaturedPosts();
                })
                .catch((error) => {
                    console.error("Error loading posts:", error);
                    let errorMessage = 'Error loading posts. ';
                    
                    if (error.code === 'permission-denied') {
                        errorMessage += 'Firestore permission denied. Please check your security rules.';
                    } else if (error.code === 'failed-precondition') {
                        errorMessage += 'Database not available. Please check if Firestore is enabled.';
                    } else {
                        errorMessage += 'Please check your connection and try again.';
                    }
                    
                    postsGrid.innerHTML = `<div class="alert alert-error">${errorMessage}</div>`;
                    featuredPosts.innerHTML = `<div class="alert alert-error">${errorMessage}</div>`;
                });
        }
        
        // Display posts in grid
        function displayPostsGrid() {
            const postsGrid = document.getElementById('posts-grid');
            postsGrid.innerHTML = '';
            
            const postsToShow = allPosts.slice(0, displayedPosts);
            
            if (postsToShow.length === 0) {
                postsGrid.innerHTML = '<p>No posts to display.</p>';
                return;
            }
            
            postsToShow.forEach((post, index) => {
                const isFeatured = index === 0;
                const postCard = document.createElement('div');
                postCard.className = `grid-post-card ${isFeatured ? 'featured' : ''}`;
                
                postCard.addEventListener('click', () => navigateToPost(post));
                
                const formattedDate = post.createdAt?.toDate().toLocaleDateString() || 'Recently';
                
                // Get comment count for this post
                let commentCount = 0;
                if (db) {
                    db.collection('comments')
                        .where('postId', '==', post.id)
                        .get()
                        .then((querySnapshot) => {
                            commentCount = querySnapshot.size;
                            // Update comment count in the card
                            const commentCountElement = postCard.querySelector('.post-comment-count');
                            if (commentCountElement) {
                                commentCountElement.innerHTML = `<i class="far fa-comment"></i> ${commentCount} ${commentCount === 1 ? 'Comment' : 'Comments'}`;
                            }
                        })
                        .catch((error) => {
                            console.error("Error loading comment count: ", error);
                        });
                }
                
                if (isFeatured) {
                    postCard.innerHTML = `
                        <div class="post-image-container">
                            <img src="${post.featuredImage || 'https://via.placeholder.com/600x400?text=Featured+Story'}" alt="${post.title}" class="grid-post-image">
                            <div class="post-category-tag">${post.category || 'Uncategorized'}</div>
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">${post.title}</h3>
                            <div class="post-meta">
                                <span class="post-date"><i class="far fa-calendar"></i> ${formattedDate}</span>
                                <span><i class="far fa-user"></i> GhanaLens</span>
                            </div>
                            <p class="post-excerpt">${post.excerpt || 'No excerpt available.'}</p>
                            <div class="post-comment-count">
                                <i class="far fa-comment"></i> ${commentCount} ${commentCount === 1 ? 'Comment' : 'Comments'}
                            </div>
                        </div>
                    `;
                } else {
                    postCard.innerHTML = `
                        <div class="post-image-container">
                            <img src="${post.featuredImage || 'https://via.placeholder.com/400x250?text=Story'}" alt="${post.title}" class="grid-post-image">
                            <div class="post-category-tag">${post.category || 'Uncategorized'}</div>
                        </div>
                        <div class="post-content">
                            <h3 class="post-title">${post.title}</h3>
                            <div class="post-meta">
                                <span class="post-date"><i class="far fa-calendar"></i> ${formattedDate}</span>
                                <span><i class="far fa-user"></i> GhanaLens</span>
                            </div>
                            <p class="post-excerpt">${post.excerpt || 'No excerpt available.'}</p>
                            <div class="post-comment-count">
                                <i class="far fa-comment"></i> ${commentCount} ${commentCount === 1 ? 'Comment' : 'Comments'}
                            </div>
                        </div>
                    `;
                }
                
                postsGrid.appendChild(postCard);
            });
        }
        
        // Display featured posts
        function displayFeaturedPosts() {
            const featuredPosts = document.getElementById('featured-posts');
            featuredPosts.innerHTML = '';
            
            // Get posts for featured section (skip first one as it's in main grid)
            const featuredPostsToShow = allPosts.slice(1, 7);
            
            if (featuredPostsToShow.length === 0) {
                featuredPosts.innerHTML = '<p>No featured posts available.</p>';
                return;
            }
            
            featuredPostsToShow.forEach((post) => {
                const postCard = document.createElement('div');
                postCard.className = 'post-card';
                postCard.innerHTML = `
                    <img src="${post.featuredImage || 'https://via.placeholder.com/300x200?text=Image+Not+Found'}" alt="${post.title}" class="post-image">
                    <div class="post-content-old">
                        <span class="post-category">${post.category || 'Uncategorized'}</span>
                        <h3 class="post-title-old">${post.title}</h3>
                        <p class="post-excerpt-old">${post.excerpt || 'No excerpt available.'}</p>
                        <div class="post-meta-old">
                            <span>By GhanaLens</span>
                            <span>${post.createdAt?.toDate().toLocaleDateString() || 'Recently'}</span>
                        </div>
                    </div>
                `;
                
                postCard.addEventListener('click', () => navigateToPost(post));
                featuredPosts.appendChild(postCard);
            });
        }
        
        // Load more posts
        function loadMorePosts() {
            displayedPosts += 6;
            displayPostsGrid();
        }
        
        // Create sample post for testing
        function createSamplePost() {
            if (!db) {
                alert('Database not available');
                return;
            }
            
            const samplePost = {
                title: "Welcome to GhanaLens - Your Window to Ghana",
                content: `
                    <p>This is your first post on GhanaLens. You can edit or delete this post in the admin dashboard.</p>
                    <p>GhanaLens is your window to Ghana, bringing you the latest news, stories, and insights from Ghana and beyond.</p>
                    <h2>About GhanaLens</h2>
                    <p>We are committed to providing quality content that informs, educates, and entertains our readers.</p>
                    <p>Stay tuned for more exciting content coming your way!</p>
                `,
                excerpt: "Welcome to GhanaLens - your window to Ghana. Discover the latest news and stories from Ghana and beyond.",
                category: "News",
                featuredImage: "https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                author: "GhanaLens",
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                published: true
            };
            
            db.collection('posts').add(samplePost)
                .then(() => {
                    alert('Sample post created successfully!');
                    loadBlogPosts();
                })
                .catch((error) => {
                    alert('Error creating sample post: ' + error.message);
                });
        }
        
        // Refresh posts
        function refreshPosts() {
            displayedPosts = 6;
            loadBlogPosts();
        }
        
        // Show admin login modal
        function showLogin() {
            document.getElementById('login-modal').style.display = 'flex';
        }
        
        // Hide admin login modal
        function hideLogin() {
            document.getElementById('login-modal').style.display = 'none';
            document.getElementById('login-alert').innerHTML = '';
        }
        
        // Enhanced alert function for admin
        function showAlert(message, type) {
            const alertContainer = document.getElementById('alert-container');
            const alertId = 'alert-' + Date.now();
            
            const alertHTML = `
                <div id="${alertId}" class="alert-dismissible alert-${type}">
                    <div class="alert-content">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                        <span>${message}</span>
                    </div>
                    <button class="alert-close" onclick="document.getElementById('${alertId}').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            alertContainer.innerHTML = alertHTML;
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                const alertElement = document.getElementById(alertId);
                if (alertElement) {
                    alertElement.remove();
                }
            }, 5000);
        }
        
        // Show login alert
        function showLoginAlert(message, type) {
            document.getElementById('login-alert').innerHTML = `<div class="alert alert-${type}">${message}</div>`;
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Initializing GhanaLens...");
            
            // Initialize Quill editors
            initQuillEditors();
            
            // Load categories and then initialize the rest of the app
            loadCategories()
                .then(() => {
                    // Populate category dropdowns
                    populateCategoryDropdowns();
                    // Display categories on homepage
                    displayCategories();
                    
                    // Set up login form
                    document.getElementById('login-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        const email = document.getElementById('login-email').value;
                        const password = document.getElementById('login-password').value;
                        
                        if (!auth) {
                            showLoginAlert('Authentication service not available', 'error');
                            return;
                        }
                        
                        auth.signInWithEmailAndPassword(email, password)
                            .then((userCredential) => {
                                currentUser = userCredential.user;
                                hideLogin();
                                document.getElementById('blog-site').style.display = 'none';
                                document.getElementById('admin-dashboard').style.display = 'block';
                                document.getElementById('admin-email').textContent = currentUser.email;
                                loadAdminData();
                            })
                            .catch((error) => {
                                showLoginAlert(error.message, 'error');
                            });
                    });
                    
                    // Set up add post form
                    document.getElementById('add-post-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const title = document.getElementById('post-title').value;
                        const category = document.getElementById('post-category').value;
                        const excerpt = document.getElementById('post-excerpt').value;
                        const featuredImage = document.getElementById('featured-image').value;
                        const content = quill.root.innerHTML;
                        
                        const newPost = {
                            title: title,
                            category: category,
                            excerpt: excerpt,
                            featuredImage: featuredImage,
                            content: content,
                            author: "GhanaLens",
                            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                            published: true
                        };
                        
                        db.collection('posts').add(newPost)
                            .then(() => {
                                showAlert('Post published successfully!', 'success');
                                document.getElementById('add-post-form').reset();
                                quill.root.innerHTML = '';
                                loadAdminData();
                                loadBlogPosts();
                            })
                            .catch((error) => {
                                showAlert('Error publishing post: ' + error.message, 'error');
                            });
                    });
                    
                    // Set up add category form
                    document.getElementById('add-category-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const name = document.getElementById('category-name').value;
                        const description = document.getElementById('category-description').value;
                        
                        const newCategory = {
                            name: name,
                            description: description,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        db.collection('categories').add(newCategory)
                            .then(() => {
                                showAlert('Category added successfully!', 'success');
                                document.getElementById('add-category-form').reset();
                                // Reload categories
                                loadCategories().then(() => {
                                    populateCategoryDropdowns();
                                    displayCategories();
                                    loadCategoriesForManagement();
                                });
                                loadAdminData();
                            })
                            .catch((error) => {
                                showAlert('Error adding category: ' + error.message, 'error');
                            });
                    });
                    
                    // Set up edit post form
                    document.getElementById('edit-post-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const postId = document.getElementById('edit-post-id').value;
                        const title = document.getElementById('edit-post-title').value;
                        const category = document.getElementById('edit-post-category').value;
                        const excerpt = document.getElementById('edit-post-excerpt').value;
                        const featuredImage = document.getElementById('edit-featured-image').value;
                        const content = editQuill.root.innerHTML;
                        
                        const updatedPost = {
                            title: title,
                            category: category,
                            excerpt: excerpt,
                            featuredImage: featuredImage,
                            content: content,
                            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                        };
                        
                        db.collection('posts').doc(postId).update(updatedPost)
                            .then(() => {
                                showAlert('Post updated successfully!', 'success');
                                closeEditModal();
                                loadPostsForManagement();
                                loadAdminData();
                                loadBlogPosts();
                            })
                            .catch((error) => {
                                showAlert('Error updating post: ' + error.message, 'error');
                            });
                    });
                    
                    // Set up comment form
                    document.getElementById('comment-form').addEventListener('submit', submitComment);
                    
                    // Add back button to post detail header
                    const headerContainer = document.querySelector('.header-container');
                    const backButton = document.createElement('button');
                    backButton.className = 'btn btn-outline';
                    backButton.innerHTML = '<i class="fas fa-arrow-left"></i> Back to Home';
                    backButton.style.display = 'none';
                    backButton.onclick = goBackToHomepage;
                    headerContainer.appendChild(backButton);
                    
                    // Show/hide back button based on view
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                                const postDetailView = document.getElementById('post-detail-view');
                                if (postDetailView.style.display === 'block') {
                                    backButton.style.display = 'block';
                                } else {
                                    backButton.style.display = 'none';
                                }
                            }
                        });
                    });
                    
                    observer.observe(document.getElementById('post-detail-view'), {
                        attributes: true,
                        attributeFilter: ['style']
                    });
                    
                    // Check authentication state
                    if (auth) {
                        auth.onAuthStateChanged((user) => {
                            if (user) {
                                currentUser = user;
                                document.getElementById('blog-site').style.display = 'none';
                                document.getElementById('admin-dashboard').style.display = 'block';
                                document.getElementById('admin-email').textContent = user.email;
                                document.getElementById('admin-display-name').textContent = user.displayName || 'Administrator';
                                loadAdminData();
                            } else {
                                currentUser = null;
                                document.getElementById('blog-site').style.display = 'block';
                                document.getElementById('admin-dashboard').style.display = 'none';
                                loadBlogPosts();
                            }
                        });
                    } else {
                        // If auth fails, still show the blog
                        document.getElementById('blog-site').style.display = 'block';
                        document.getElementById('admin-dashboard').style.display = 'none';
                        loadBlogPosts();
                    }
                })
                .catch((error) => {
                    console.error("Error loading categories: ", error);
                });
        });

        // Enhanced admin functions
        function showAdminSection(section) {
            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(el => {
                el.style.display = 'none';
            });
            
            // Remove active class from all menu items
            document.querySelectorAll('.admin-menu a').forEach(el => {
                el.classList.remove('active');
            });
            
            // Add active class to clicked menu item
            event.target.classList.add('active');
            
            // Show selected section
            document.getElementById(section + '-section').style.display = 'block';
            
            // Update title
            const titles = {
                'dashboard': 'Dashboard',
                'add-post': 'Create New Post',
                'manage-posts': 'Manage Posts',
                'manage-categories': 'Manage Categories',
                'manage-comments': 'Manage Comments',
                'analytics': 'Analytics'
            };
            document.getElementById('admin-section-title').textContent = titles[section];
            
            // Load data for specific sections
            if (section === 'manage-posts') {
                loadPostsForManagement();
            } else if (section === 'manage-categories') {
                loadCategoriesForManagement();
            } else if (section === 'manage-comments') {
                loadCommentsForManagement();
            }
        }

        function loadAdminData() {
            if (!db) return;
            
            // Load posts count
            db.collection('posts').get().then((querySnapshot) => {
                const count = querySnapshot.size;
                document.getElementById('total-posts').textContent = count;
                document.getElementById('posts-count-badge').textContent = count;
            });
            
            // Load categories count
            db.collection('categories').get().then((querySnapshot) => {
                const count = querySnapshot.size;
                document.getElementById('total-categories').textContent = count;
                document.getElementById('categories-count-badge').textContent = count;
            });
            
            // Load comments count
            db.collection('comments').get().then((querySnapshot) => {
                const count = querySnapshot.size;
                document.getElementById('total-comments').textContent = count;
                document.getElementById('comments-count-badge').textContent = count;
            });
        }

        // Toggle sidebar on mobile
        function toggleSidebar() {
            const sidebar = document.querySelector('.admin-sidebar');
            sidebar.classList.toggle('collapsed');
        }

        function loadPostsForManagement() {
            if (!db) return;
            
            const postsList = document.getElementById('posts-list');
            postsList.innerHTML = '<div class="loading">Loading posts...</div>';
            
            db.collection('posts').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    postsList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        postsList.innerHTML = '<p>No posts found.</p>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const post = doc.data();
                        const postElement = document.createElement('div');
                        postElement.className = 'admin-card';
                        postElement.innerHTML = `
                            <h3>${post.title}</h3>
                            <p><strong>Category:</strong> ${post.category}</p>
                            <p><strong>Date:</strong> ${post.createdAt?.toDate().toLocaleDateString() || 'N/A'}</p>
                            <p><strong>Status:</strong> ${post.published ? 'Published' : 'Draft'}</p>
                            <div style="margin-top: 15px;">
                                <button class="btn-admin" onclick="editPost('${doc.id}')">
                                    <i class="fas fa-edit"></i>
                                    Edit
                                </button>
                                <button class="btn-danger" onclick="deletePost('${doc.id}')">
                                    <i class="fas fa-trash"></i>
                                    Delete
                                </button>
                            </div>
                        `;
                        postsList.appendChild(postElement);
                    });
                })
                .catch((error) => {
                    postsList.innerHTML = '<p>Error loading posts.</p>';
                });
        }

        function loadCategoriesForManagement() {
            if (!db) return;
            
            const categoriesList = document.getElementById('categories-list-admin');
            categoriesList.innerHTML = '<div class="loading">Loading categories...</div>';
            
            db.collection('categories').orderBy('name').get()
                .then((querySnapshot) => {
                    categoriesList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        categoriesList.innerHTML = '<p>No categories found.</p>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const category = doc.data();
                        const categoryElement = document.createElement('div');
                        categoryElement.className = 'category-card';
                        categoryElement.innerHTML = `
                            <h3>${category.name}</h3>
                            <p>${category.description || 'No description available.'}</p>
                            <div class="category-actions">
                                <button class="btn-admin" onclick="editCategory('${doc.id}')">
                                    <i class="fas fa-edit"></i>
                                    Edit
                                </button>
                                <button class="btn-danger" onclick="deleteCategory('${doc.id}')">
                                    <i class="fas fa-trash"></i>
                                    Delete
                                </button>
                            </div>
                        `;
                        categoriesList.appendChild(categoryElement);
                    });
                })
                .catch((error) => {
                    categoriesList.innerHTML = '<p>Error loading categories.</p>';
                });
        }

        function loadCommentsForManagement() {
            if (!db) return;
            
            const commentsList = document.getElementById('comments-list-admin');
            commentsList.innerHTML = '<div class="loading">Loading comments...</div>';
            
            db.collection('comments').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    commentsList.innerHTML = '';
                    
                    if (querySnapshot.empty) {
                        commentsList.innerHTML = '<p>No comments found.</p>';
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const comment = doc.data();
                        const commentElement = document.createElement('div');
                        commentElement.className = 'admin-card';
                        commentElement.innerHTML = `
                            <h4>Comment on Post ID: ${comment.postId}</h4>
                            <p><strong>Author:</strong> ${comment.author}</p>
                            <p><strong>Date:</strong> ${comment.createdAt?.toDate().toLocaleDateString() || 'N/A'}</p>
                            <p><strong>Comment:</strong> ${comment.content}</p>
                            <div style="margin-top: 15px;">
                                <button class="btn-danger" onclick="deleteComment('${doc.id}')">
                                    <i class="fas fa-trash"></i>
                                    Delete
                                </button>
                            </div>
                        `;
                        commentsList.appendChild(commentElement);
                    });
                })
                .catch((error) => {
                    commentsList.innerHTML = '<p>Error loading comments.</p>';
                });
        }

        function editPost(postId) {
            // Load post data and open edit modal
            db.collection('posts').doc(postId).get()
                .then((doc) => {
                    if (doc.exists) {
                        const post = doc.data();
                        
                        // Populate form fields
                        document.getElementById('edit-post-id').value = postId;
                        document.getElementById('edit-post-title').value = post.title;
                        document.getElementById('edit-post-excerpt').value = post.excerpt;
                        document.getElementById('edit-featured-image').value = post.featuredImage;
                        
                        // Set category
                        const categorySelect = document.getElementById('edit-post-category');
                        categorySelect.value = post.category || '';
                        
                        // Set content in editor
                        editQuill.root.innerHTML = post.content || '';
                        
                        // Show modal
                        document.getElementById('edit-post-modal').style.display = 'flex';
                    } else {
                        showAlert('Post not found', 'error');
                    }
                })
                .catch((error) => {
                    showAlert('Error loading post: ' + error.message, 'error');
                });
        }

        function closeEditModal() {
            document.getElementById('edit-post-modal').style.display = 'none';
        }

        function editCategory(categoryId) {
            // In a real implementation, you would show an edit form for the category
            showAlert('Edit category functionality would open here for category: ' + categoryId, 'info');
        }

        function deletePost(postId) {
            if (confirm('Are you sure you want to delete this post?')) {
                db.collection('posts').doc(postId).delete()
                    .then(() => {
                        showAlert('Post deleted successfully!', 'success');
                        loadPostsForManagement();
                        loadAdminData();
                        loadBlogPosts();
                    })
                    .catch((error) => {
                        showAlert('Error deleting post: ' + error.message, 'error');
                    });
            }
        }

        function deleteCategory(categoryId) {
            if (confirm('Are you sure you want to delete this category?')) {
                db.collection('categories').doc(categoryId).delete()
                    .then(() => {
                        showAlert('Category deleted successfully!', 'success');
                        loadCategoriesForManagement();
                        loadAdminData();
                        // Reload categories everywhere
                        loadCategories().then(() => {
                            populateCategoryDropdowns();
                            displayCategories();
                        });
                    })
                    .catch((error) => {
                        showAlert('Error deleting category: ' + error.message, 'error');
                    });
            }
        }

        function deleteComment(commentId) {
            if (confirm('Are you sure you want to delete this comment?')) {
                db.collection('comments').doc(commentId).delete()
                    .then(() => {
                        showAlert('Comment deleted successfully!', 'success');
                        loadCommentsForManagement();
                        loadAdminData();
                    })
                    .catch((error) => {
                        showAlert('Error deleting comment: ' + error.message, 'error');
                    });
            }
        }

        function logout() {
            if (auth) {
                auth.signOut();
            }
        }
    </script>
</body>
</html>
